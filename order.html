<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Your Order - Framed by Sixteen28</title>
    <style>
        :root {
            --primary-color: #EE82EE;
            --secondary-color: #FF7F50;
            --accent-color-1: #FF69B4;
            --accent-color-2: #FFD700;
            --accent-color-3: #1E90FF;
            --light-color: #F9F9F9;
            --dark-color: #333333;
            --gray-color: #777777;
            --light-gray: #EEEEEE;
            --font-heading: 'Playfair Display', serif;
            --font-body: 'Poppins', sans-serif;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            color: var(--dark-color);
            line-height: 1.6;
            background-color: var(--light-color);
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }

        h1 {
            font-family: var(--font-heading);
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        p {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        a {
            display: inline-block;
            background-color: #25D366;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
        }

        a:hover {
            background-color: #1ebe57;
        }

        .order-image {
            max-width: 200px;
            display: block;
            margin: 10px auto;
            border-radius: 8px;
        }

        .error-message {
            color: #d32f2f;
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        /* Responsive Styles */

        /* Laptop L - 1440px */
        @media screen and (max-width: 1440px) {
            .container {
                max-width: 550px;
                padding: 18px;
            }
            h1 { font-size: 2.3rem; margin-bottom: 0.9rem; }
            p { font-size: 1.05rem; margin-bottom: 0.9rem; }
            a { padding: 9px 18px; font-size: 0.95rem; border-radius: 4px; }
            .order-image { max-width: 180px; margin: 9px auto; border-radius: 7px; }
            .error-message { font-size: 0.95rem; margin-bottom: 0.9rem; }
            body { padding: 18px; }
        }

        /* Laptop - 1024px */
        @media screen and (max-width: 1024px) {
            .container {
                max-width: 500px;
                padding: 15px;
            }
            h1 { font-size: 2.1rem; margin-bottom: 0.8rem; }
            p { font-size: 1rem; margin-bottom: 0.8rem; }
            a { padding: 8px 16px; font-size: 0.9rem; border-radius: 4px; }
            .order-image { max-width: 160px; margin: 8px auto; border-radius: 6px; }
            .error-message { font-size: 0.9rem; margin-bottom: 0.8rem; }
            body { padding: 15px; }
        }

        /* Tablet - 768px */
        @media screen and (max-width: 768px) {
            .container {
                max-width: 450px;
                padding: 12px;
            }
            h1 { font-size: 1.9rem; margin-bottom: 0.7rem; }
            p { font-size: 0.95rem; margin-bottom: 0.7rem; }
            a { padding: 7px 14px; font-size: 0.85rem; border-radius: 3px; }
            .order-image { max-width: 140px; margin: 7px auto; border-radius: 5px; }
            .error-message { font-size: 0.85rem; margin-bottom: 0.7rem; }
            body { padding: 12px; }
        }

        /* Mobile L - 425px */
        @media screen and (max-width: 425px) {
            .container {
                max-width: 100%;
                padding: 10px;
            }
            h1 { font-size: 1.7rem; margin-bottom: 0.6rem; }
            p { font-size: 0.9rem; margin-bottom: 0.6rem; }
            a { padding: 6px 12px; font-size: 0.8rem; border-radius: 3px; }
            .order-image { max-width: 120px; margin: 6px auto; border-radius: 4px; }
            .error-message { font-size: 0.8rem; margin-bottom: 0.6rem; }
            body { padding: 10px; }
        }

        /* Mobile M - 375px */
        @media screen and (max-width: 375px) {
            .container {
                max-width: 100%;
                padding: 8px;
            }
            h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
            p { font-size: 0.85rem; margin-bottom: 0.5rem; }
            a { padding: 5px 10px; font-size: 0.75rem; border-radius: 2px; }
            .order-image { max-width: 100px; margin: 5px auto; border-radius: 3px; }
            .error-message { font-size: 0.75rem; margin-bottom: 0.5rem; }
            body { padding: 8px; }
        }

        /* Mobile S - 320px */
        @media screen and (max-width: 320px) {
            .container {
                max-width: 100%;
                padding: 6px;
            }
            h1 { font-size: 1.3rem; margin-bottom: 0.4rem; }
            p { font-size: 0.8rem; margin-bottom: 0.4rem; }
            a { padding: 4px 8px; font-size: 0.7rem; border-radius: 2px; }
            .order-image { max-width: 90px; margin: 4px auto; border-radius: 2px; }
            .error-message { font-size: 0.7rem; margin-bottom: 0.4rem; }
            body { padding: 6px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Review Your Order</h1>
        <p id="loadingMessage">Loading order...</p>
        <div id="orderDetails"></div>
        <a id="whatsappLink" href="#">Continue on WhatsApp</a>
        <p>Please review before confirming on WhatsApp.</p>
    </div>
    <script type="text/javascript">
    const orderDetails = document.getElementById('orderDetails');
    const whatsappLink = document.getElementById('whatsappLink');
    const loadingMessage = document.getElementById('loadingMessage');

    let orderText = 'No order details found.';
    let orderObj = [];
    let whatsappMessage = 'No order details available.';
    const phone = '12462642892'; 

    const params = new URLSearchParams(window.location.search);
    const encodedOrder = params.get('order');

    if (encodedOrder) {
        const decodedOrder = decodeURIComponent(encodedOrder);
        try {
            orderObj = JSON.parse(decodedOrder);
            if (Array.isArray(orderObj) && orderObj.length > 0) {
                orderText = orderObj.map(item => `$${item.price.toFixed(2)}`).join('<br>');
                // âœ… Pair each price with its image link
                whatsappMessage = orderObj.map(item =>
                    `$${item.price.toFixed(2)} ${window.location.origin}/${item.image}`
                ).join('\n');
            } else {
                orderText = 'Order is empty or invalid.';
                orderDetails.insertAdjacentHTML('beforebegin', '<p class="error-message">Error: Invalid order data in URL.</p>');
            }
        } catch (e) {
            console.warn('Failed to parse order as JSON:', e.message);
            orderText = decodedOrder.replace(/\n/g, '<br>');
            whatsappMessage = decodedOrder;
            orderDetails.insertAdjacentHTML('beforebegin', '<p class="error-message">Warning: Order data is not in expected format. Displaying as text.</p>');
        }
    }

    // ðŸ”„ Fallback only if no valid orderObj came from URL
    if (!orderObj || !orderObj.length) {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        if (cart.length > 0) {
            orderObj = cart;
            orderText = cart.map(item => `$${item.price.toFixed(2)}`).join('<br>');
            // âœ… Pair each price with its image link
            whatsappMessage = cart.map(item =>
                `$${item.price.toFixed(2)} ${window.location.origin}/${item.image}`
            ).join('\n');
        } else if (!encodedOrder) {
            orderDetails.insertAdjacentHTML('beforebegin', '<p class="error-message">Error: No order data found in URL or localStorage.</p>');
        }
    }

    // Hide loading
    loadingMessage.style.display = 'none';

    // Show order details
    orderDetails.innerHTML = orderText;

    // âœ… Display images above order details
    if (orderObj.length > 0) {
        orderObj.forEach(item => {
            if (item.image) {
                const img = document.createElement('img');
                img.src = item.image;
                img.alt = 'Product image';
                img.className = 'order-image';
                orderDetails.insertAdjacentElement('beforebegin', img);
            }
        });
    }

    // WhatsApp link
    const waLink = `https://wa.me/${phone}?text=${encodeURIComponent(whatsappMessage)}`;
    whatsappLink.href = waLink;
    </script>
</body>
</html>

